<?xml version='1.0' encoding='UTF-8'?>
<odoo>
    <!-- MULTI COMPANY USER -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'base'), ('name', '=', 'res_users_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <!--Finish the job, i.e. inheriting/modifying some fields-->
    <record id="base.res_users_rule" model="ir.rule">            
        <field name="domain_force">[('company_ids', 'in', company_ids)]</field>        
    </record>
    <function model="ir.model.data" name="write">                          
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'base'), ('name', '=', 'res_users_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- TASK -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'task_comp_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="project.task_comp_rule" model="ir.rule">            
        <field name="domain_force">['|', ('company_id', 'in', company_ids), ('project_id.classification','=','internal')]</field>        
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'task_comp_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- PROJECT -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'project_comp_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="project.project_comp_rule" model="ir.rule">            
        <field name="domain_force">['|' , ('company_id', 'in', company_ids),('classification','=','internal')]</field>        
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'project_comp_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- PROJECT VISIBILITY -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'task_visibility_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="project.task_visibility_rule" model="ir.rule">            
        <field name="perm_unlink"></field>
        <field name="perm_read"></field>
        <field name="perm_write"></field>
        <field name="groups" eval="[(4, ref('project.group_project_user'))]"/>
        <field name="domain_force">[('project_id.classification','!=','external'),
'|','|',('user_id', '=', user.id), ('project_id.tasks.create_uid.id','=',user.id), ('project_id.tasks.user_id','=',user.id)]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'task_visibility_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- PROJECT VISIBILITY -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'project_public_members_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="project.project_public_members_rule" model="ir.rule">            
        <field name="perm_unlink"></field>
        <field name="perm_create"></field>
        <field name="perm_write"></field>
        <field name="groups" eval="[(4, ref('project.group_project_user'))]"/>
        <field name="domain_force">['|', '&amp;', ('classification','=','internal'),
          '|', '|',
              '&amp;',('privacy_visibility', '=', 'followers'),('message_is_follower','=', 1),
              '&amp;',('privacy_visibility', '=', 'employees'),(1, '=', 1),
              '&amp;',('privacy_visibility', '=', 'portal'),('message_partner_ids', 'child_of', [user.partner_id.commercial_partner_id.id]),
'&amp;', ('classification','=','external'), '|','|','|','|',('user_id','=', user.id), ('tasks.user_id', '=', user.id), ('create_uid', '=', user.id), ('sale_order_id.user_id','=', user.id),('sale_order_id.team_id.user_id','=',user.id)
]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'project'), ('name', '=', 'project_public_members_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- SALES -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_line_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.sale_order_line_personal_rule" model="ir.rule">            
        <field name="domain_force">[('salesman_id','=',user.id)]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_line_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.sale_order_personal_rule" model="ir.rule">            
        <field name="domain_force">[('user_id','in',[user.id,False])]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'account_invoice_report_rule_see_personal')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.account_invoice_report_rule_see_personal" model="ir.rule">            
        <field name="domain_force">[('invoice_user_id', '=', user.id)]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'account_invoice_report_rule_see_personal')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_report_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.sale_order_report_personal_rule" model="ir.rule">            
        <field name="groups" eval="[(4, ref('group_sales_sales_manager'))]"/>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'sale_order_report_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'payment_transaction_salesman_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.payment_transaction_salesman_rule" model="ir.rule">            
        <field name="groups" eval="[(4, ref('group_sales_sales_manager'))]"/>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'payment_transaction_salesman_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'payment_token_salesman_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale.payment_token_salesman_rule" model="ir.rule">            
        <field name="groups" eval="[(4, ref('group_sales_sales_manager'))]"/>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale'), ('name', '=', 'payment_token_salesman_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- CRM -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'crm'), ('name', '=', 'crm_activity_report_rule_personal_activities')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="crm.crm_activity_report_rule_personal_activities" model="ir.rule">            
        <field name="domain_force">[('user_id','=',user.id)]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'crm'), ('name', '=', 'crm_activity_report_rule_personal_activities')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'crm'), ('name', '=', 'crm_rule_personal_lead')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="crm.crm_rule_personal_lead" model="ir.rule">            
        <field name="perm_unlink"></field>
        <field name="perm_read"></field>
        <field name="perm_write"></field>
        <field name="perm_create"></field>
        <field name="domain_force">[('type','=','lead')]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'crm'), ('name', '=', 'crm_rule_personal_lead')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

    <!-- SUBSCRIPTION -->
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale_subscription'), ('name', '=', 'sale_subscription_report_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': False}" />
    </function>
    <record id="sale_subscription.sale_subscription_report_personal_rule" model="ir.rule">            
        <field name="domain_force">[('user_id','=',user.id)]</field>
    </record>
    <function model="ir.model.data" name="write">
        <function name="search" model="ir.model.data">
            <value eval="[('module', '=', 'sale_subscription'), ('name', '=', 'sale_subscription_report_personal_rule')]"/>
        </function>
        <value eval="{'noupdate': True}" />
    </function>

</odoo>